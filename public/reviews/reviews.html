<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.108.0">
    <title>Reviews</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="canonical" href="https://getbootstrap.com/docs/5.3/examples/headers/">
    <!-- <link href="../assets/dist/css/bootstrap.min.css" rel="stylesheet"> -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;0,1000;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900;1,1000&display=swap"
        rel="stylesheet">
</head>

<body class="text-light" style="background-color: #000;">
    <div class="cover-container d-f p-3 mx-auto flex-column">

        <nav class="navbar navbar-expand-sm p-3 m-2 fixed-top" id="navBar" style="background-color: #000;"
            aria-label="Header">
            <div class="container-fluid">
                <a href="/" class="d-flex align-items-center mt-2 mb-2 mb-lg-0 pe-3 text-white text-decoration-none">
                    <img src="../assets/brand/SPdvdRentals.png" class="appLogo bi me-2" width="auto" height="32"
                        role="img" />
                </a>
                <button class="navbar-toggler btn btn-dark" id="navBarButton" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav mt-2 me-auto mb-2 mb-lg-0" id="ComFont">
                        <li><a href="/" class="nav-link px-2 text-white fs-5">&nbspHomepage</a></li>
                        <li><a href="/searchResults" class="nav-link px-3 text-secondary fs-5" id="movieBtn">Movie
                                Titles</a>
                        </li>
                        <a id="AdminPrivilleges" class="nav-link px-3 text-warning fs-5"></a>
                    </ul>


                    <!-- <form class="col-12 col-lg-auto col-lg-5 mb-3 mb-lg-0 me-lg-3" role="search">
                                <label for="searchBar">Email address</label>
                                <input type="search" class="form-control form-control-dark text-bg-dark" id="searchBar"
                                    placeholder="Search for Movie titles, Categories and More" aria-label="Search">
                            </form> -->
                    <form class="d-flex" role="search">
                        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                        <button class="btn btn-outline-success" type="submit">Search</button>
                    </form>

                    <div class="text-end">
                        <a href="/login/"><button type="button" class="btn btn-warning me-2">Login</button></a>
                    </div>
                </div>
            </div>
    </div>
    </nav>
    <main>
        <section>
            <div class="container text-light mt-5 pt-5 ms-3">
                <div id="main" class="row ">
                    <h1>Reviews</h1>
                </div>
            </div>
            <div class="container text-light pt-5 ms-3">
                <h4>Thompson Dave</h4>
                <p class="rating">Rating</p>
                <p class="review">Review</p>
            </div>
            <form id="reviewForm">
                <input type="number" id="rating" name="rating" placeholder="what would you rate this movie out of 5?"
                    required>
                <input type="text" id="review" name="Review" placeholder="Give review..." required>
                <button type="submit" id="post" class="btn btn-primary">Submit</button>
            </form>
            <form id="alterForm">
                <input type="number" id="reviewID" name="reviewID" placeholder="which review would you want to delete?"
                    required>
                <input type="number" id="alterRating" name="newRating"
                    placeholder="what would you rate this movie out of 5?" required>
                <input type="text" id="alterReview" name="Review" placeholder="Give review..." required>
                <button type="submit" id="update" class="btn btn-primary">Submit3</button>
            </form>
            <form id="deleteForm">
                <input type="number" id="deleteID" name="deleteID" placeholder="which review would you want to delete?"
                    required>
                <button type="submit" id="delete" class="btn btn-primary">Delete</button>
            </form>
            <!-- <form id="retrieveForm">
                <div id="results">
                </div>
                <button type="submit" id="retrieve" class="btn btn-primary">Retrieve</button>
            </form> -->
            <p id="results">
            </p>
        </section>
    </main>
    </div>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="Reviews.js"></script>
    <script src="../../models/review.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>

    <script>
        // window.addEventListener('DOMContentLoaded', function () {
        // Post review
        const submit = document.getElementById("post")
        submit.addEventListener("click", (event) => {
            event.preventDefault();
            const postComment = document.getElementById("review").value
            const postRating = document.getElementById("rating").value
            console.log(postComment, postRating)
            const post = {

                Comments: postComment,
                Rating: postRating
            }

            const baseUrl = "http://localhost:3000"
            axios.post(`${baseUrl}/reviews`, post)
                .then((response) => {
                    if (response.status == 200) {
                        console.log("Review submitted!")
                    } else {
                        console.log("An error occurred")
                    }
                })
        })

        //update review
        const submit3 = document.getElementById("update")
        submit3.addEventListener("click", (event) => {
            event.preventDefault();
            const reviewID = document.getElementById("reviewID").value
            const newRating = document.getElementById("alterRating").value
            const newReview = document.getElementById("alterReview").value
            console.log(reviewID, newReview)
            const update = {
                ReviewID: reviewID,
                Rating: newRating,
                Comments: newReview
            }

            const baseUrl = "http://localhost:3000"
            axios.put(`${baseUrl}/reviews`, update)
                .then((response) => {
                    if (response.status == 200) {
                        console.log("Review submitted!")
                    } else {
                        console.log("An error occurred")
                    }
                })
        })

        //delete review
        const deleteBtn = document.getElementById("delete")
        deleteBtn.addEventListener("click", (event) => {
            const id = document.getElementById("deleteID").value
            const baseUrl = "http://localhost:3000";
            axios.delete(`${baseUrl}/reviews/${id}`)
                .then((response) => {
                    if (response.status == 200) {
                        console.log("Review deleted!");
                    } else {
                        console.log("An error occurred");
                    }
                });
            // const deleted = {
            //     ReviewID : deleteReview
            // }

            // const baseUrl = "http://localhost:3000"
            // axios.delete(`${baseUrl}/reviews`, deleted)
            //     .then((response) => {
            //         if (response.status == 200) {
            //             console.log("Review submitted!")
            //         } else {
            //             console.log("An error occurred")
            //         }
            //     })
        })

        // Get review
        const submit2 = document.getElementById("retrieve");
        submit2.addEventListener("click", (event) => {
            event.preventDefault(); // Prevent default form submission behavior
            const resultsContainer = document.getElementById("results");
            console.log("fish")
            const baseUrl = "http://localhost:3000";

            axios.get(`${baseUrl}/reviews/data`)
                .then((response) => {

                    const retrieved = response.data;
                    console.log(retrieved)
                    for (let i = 0; i < retrieved.length; i++) {
                        // resultsContainer.innerHtml = '';

                        // retrieved.forEach((review) => {
                        // const reviewElement = document.createElement("div");
                        const reviewData = `
          <h4>${retrieved[i].UserID}</h4>
          <p class="rating">${retrieved[i].Rating}</p>
          <p class="review">${retrieved[i].Comments}</p>
        `;
                        $("#results").append(reviewData);
                    }
                })
                .catch((error) => {
                    console.log("An error occurred:", error);
                });
        })

        // Get highest reviews and comments of a movie



    </script>